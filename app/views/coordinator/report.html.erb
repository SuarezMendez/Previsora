<%= javascript_include_tag "coordinator" %>

<div class="m-30-60">
  <%= search_form_for @search, url: coordinator_report_url, class:"" do |f| %>
    <div class="row">
      <div class="col-sm-4">
        <div class="styled-select m-5">
          <%= f.select :p_type_eq, options_for_select([["TIPO DE PROCESO", nil], ["PROCESO PREJUDICIAL", 1], ["PROCESO JUDICIAL", 2], ["RESPONSABILIDAD FISCAL", 3], ["PROCEDIMIENTO ADMINISTRATIVO", 4], ["TUTELA", 5]]), {}, {} %>
        </div>
      </div>
      <div class="col-sm-offset-4 col-sm-4 center">
        <button type="submit" class="minibtn btn-default">
          <span class="glyphicon glyphicon-search"></span>
        </button>
        <%= link_to coordinator_report_path, class:"minibtn btn-default" do %>
          <span class="glyphicon glyphicon-refresh"></span>
        <% end %>
        <%= link_to coordinator_report_path(request.parameters.merge({:format => :xls})), download: 'reporte.xls', class:"minibtn btn-default" do %>
          <span class="glyphicon glyphicon-download"></span>
        <% end %>
        <button id="filter_btn" type="button" class="minibtn btn-default" data-toggle="collapse" data-target="#demo">
          <span class="glyphicon glyphicon-chevron-down"></span>
        </button>
      </div>
    </div>

    <div id="demo" class="collapse">
      <div class="row">
        <div class="col-sm-4">
          <div class="styled-select m-5">
            <select name="type_process[city_case_eq]" id="cities">
              <option value="" selected="selected">CIUDAD</option>
            </select>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="styled-select m-5">
            <%= f.select :departament_eq, options_from_collection_for_select(TypeProcess.get_all_departament, :first, :last, '2'), {prompt: "DEPARTAMENTO"}, {id:"departament", class:"form-control"} %>
          </div>
        </div>
        <div class="col-sm-4">
          <%= f.text_field :office_name_cont, placeholder: "NOMBRE DESPACHO", class:"form-control m-5 mb-5" %>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <%= f.text_field :passive_part_cont, placeholder: "TERMINACION DEL CASO", class:"form-control m-5 mb-5" %>
        </div>
        <div class="col-sm-4">
          <%= f.text_field :passive_part_cont, placeholder: "ESTADO DEL CASO", class:"form-control m-5 mb-5" %>
        </div>
      </div>


      <h5 class="center"><b>Fecha de creación</b></h5>
      <div class="row">
        <div class="col-sm-offset-2 col-sm-1">
          <%= f.label "Desde", class:"m-5 mb-5" %>
        </div>
        <div class="col-sm-3">
          <%= f.date_field :creation_date_gteq, value: "1980-01-01", class:"form-control m-5 mb-5" %>
        </div>
        <div class="col-sm-1">
          <%= f.label "Hasta", class:"m-5 mb-5" %>
        </div>
        <div class="col-sm-3">
          <%= f.date_field :creation_date_lteq, value: Date.today, class:"form-control m-5 mb-5" %>
        </div>
      </div>

      <h5 class="center"><b>Fecha de decisión</b></h5>
      <div class="row">
        <div class="col-sm-offset-2 col-sm-1">
          <%= f.label "Desde", class:"m-5 mb-5" %>
        </div>
        <div class="col-sm-3">
          <%= f.date_field :desition_date_gteq, value: "1980-01-01", class:"form-control m-5 mb-5" %>
        </div>
        <div class="col-sm-1">
          <%= f.label "Hasta", class:"m-5 mb-5" %>
        </div>
        <div class="col-sm-3">
          <%= f.date_field :desition_date_lteq, value: Date.today, class:"form-control m-5 mb-5" %>
        </div>
      </div>

      <h5 class="center"><b>Fecha última actuación</b></h5>
      <div class="row">
        <div class="col-sm-offset-2 col-sm-1">
          <%= f.label "Desde", class:"m-5 mb-5" %>
        </div>
        <div class="col-sm-3">
          <%= f.date_field :last_performance_date_gteq, value: "1980-01-01", class:"form-control m-5 mb-5" %>
        </div>
        <div class="col-sm-1">
          <%= f.label "Hasta", class:"m-5 mb-5" %>
        </div>
        <div class="col-sm-3">
          <%= f.date_field :last_performance_date_lteq, value: Date.today, class:"form-control m-5 mb-5" %>
        </div>
      </div>
    </div>
  <% end %>
  <br>

  <div class="floatRight">
    Procesos <%= @page+1 %>-<%= @processes.length + @page %> de <%= @search.result.length %>
  </div>
  <br>
  <br>

  <table class="table table-hover table-responsive">
    <thead>
      <tr class="to-uc">
        <th class="center" scope="col"><%= sort_link @search, :p_type, "Proceso", {}, :class => 'link' %></th>
        <th class="center" scope="col"><%= sort_link @search, :correspondency_radicate, "N° Correspondencia", {}, :class => 'link' %></th>
        <th class="center" scope="col"><%= sort_link @search, :case_id_bap, "N° Bizagi, Acces, PA", {}, :class => 'link' %></th>
        <th class="center" scope="col"><%= sort_link @search, :case_id_sise, "N° SISE", {}, :class => 'link' %></th>
        <th class="center" scope="col"><%= sort_link @search, :user_id, "Abogado", {}, :class => 'link' %></th>
        <th class="center" scope="col"><%= sort_link @search, :city_case_id, "Ciudad", {}, :class => 'link' %></th>
      </tr>
    </thead>

    <tbody>
      <% if @processes == [] %>
        <tr class='clickable-row' data-href='#'>
        </tr>
      <% else %>
        <% @processes.each do |p| %>
          <tr class='clickable-row' data-href='<%= type_process_path(p) %>'>
            <td class="center"><%= p.get_type_process %></td>
            <td class="center"><%= p.correspondency_radicate %></td>
            <td class="center"><%= p.case_id_bap %></td>
            <td class="center"><%= p.case_id_sise %></td>
            <td class="center"><%= User.find(p.user_id).name %></td>
            <td class="center"><%= p.city_case %></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
  <br>

  <div class="container-fluid center">
    <%= will_paginate @processes, renderer: BootstrapPagination::Rails, class: "pagination-lg", :previous_label => t("Anterior"), :next_label => t("Siguiente")%>
  </div>
</div>
